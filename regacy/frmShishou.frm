VERSION 5.00
Object = "{C5DE3F80-3376-11D2-BAA4-04F205C10000}#1.0#0"; "vsFlex6d.ocx"
Begin VB.Form frmShishou 
   Caption         =   "éxè≥"
   ClientHeight    =   8100
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   11355
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   8100
   ScaleWidth      =   11355
   WindowState     =   2  'ç≈ëÂâª
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   765
      Index           =   0
      Left            =   360
      TabIndex        =   0
      Top             =   780
      Width           =   9015
      _ExtentX        =   15901
      _ExtentY        =   1349
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   50
      Cols            =   10
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   765
      Index           =   4
      Left            =   360
      TabIndex        =   4
      Top             =   5100
      Width           =   9015
      _ExtentX        =   15901
      _ExtentY        =   1349
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   50
      Cols            =   10
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   975
      Index           =   1
      Left            =   360
      TabIndex        =   1
      Top             =   2280
      Width           =   4875
      _ExtentX        =   8599
      _ExtentY        =   1720
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   975
      Index           =   3
      Left            =   5340
      TabIndex        =   3
      Top             =   2280
      Width           =   4455
      _ExtentX        =   7858
      _ExtentY        =   1720
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   975
      Index           =   5
      Left            =   360
      TabIndex        =   5
      Top             =   6420
      Width           =   5175
      _ExtentX        =   9128
      _ExtentY        =   1720
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   255
      Index           =   2
      Left            =   7680
      TabIndex        =   2
      Top             =   1680
      Width           =   1515
      _ExtentX        =   2672
      _ExtentY        =   450
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VB.Label Label9 
      AutoSize        =   -1  'True
      Caption         =   "ï‚ã≠ìSãÿ"
      Height          =   180
      Left            =   360
      TabIndex        =   14
      Top             =   6180
      Width           =   720
   End
   Begin VB.Label Label8 
      AutoSize        =   -1  'True
      Caption         =   "î†î≤Ç´ê°ñ@"
      Height          =   180
      Left            =   360
      TabIndex        =   13
      Top             =   4860
      Width           =   870
   End
   Begin VB.Label Label7 
      Appearance      =   0  'Ã◊Øƒ
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      BorderStyle     =   1  'é¿ê¸
      Caption         =   " ÉXÉgÉbÉpÅ[ãyÇ—ç|ñ_"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   240
      TabIndex        =   12
      Top             =   4320
      Width           =   2010
   End
   Begin VB.Label Label6 
      AutoSize        =   -1  'True
      Caption         =   "ÉsÉbÉ`äÑÇË"
      Height          =   180
      Left            =   6600
      TabIndex        =   11
      Top             =   2040
      Width           =   945
   End
   Begin VB.Label Label5 
      AutoSize        =   -1  'True
      Caption         =   "(3) ñ≥é˚èkÉÇÉãÉ^Éãï‚ã≠ãÿ"
      Height          =   180
      Left            =   5340
      TabIndex        =   10
      Top             =   1740
      Width           =   2010
   End
   Begin VB.Label Label4 
      AutoSize        =   -1  'True
      Caption         =   "(2) åBç¿ï‚ã≠ìSãÿ"
      Height          =   180
      Left            =   360
      TabIndex        =   9
      Top             =   1980
      Width           =   1350
   End
   Begin VB.Label Label24 
      AutoSize        =   -1  'True
      Caption         =   "(1) ê°ñ@"
      Height          =   180
      Left            =   360
      TabIndex        =   8
      Top             =   540
      Width           =   630
   End
   Begin VB.Label Label2 
      Caption         =   "íPà  mm"
      Height          =   180
      Left            =   1920
      TabIndex        =   7
      Top             =   240
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Label Label1 
      Appearance      =   0  'Ã◊Øƒ
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      BorderStyle     =   1  'é¿ê¸
      Caption         =   " éx è≥ "
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   240
      TabIndex        =   6
      Top             =   180
      Width           =   705
   End
End
Attribute VB_Name = "frmShishou"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Const cintNumCtrl As Integer = 6
Dim Grid(cintNumCtrl - 1) As Object
Dim intBack(cintNumCtrl - 1) As Integer  'ëOÇÃÉOÉäÉbÉhÉiÉìÉoÅ[
Dim intNext(cintNumCtrl - 1) As Integer  'éüÇÃÉOÉäÉbÉhÉiÉìÉoÅ[

Dim bIgnoreHighLight As Boolean
Dim bLoadNow As Boolean
Dim bolCellNoMove As Boolean

Private Sub Form_Load()
    Dim i As Integer

    Call faShishouInit
    
    'çÏã∆ÉfÉBÉåÉNÉgÉäÇ…ÉtÉ@ÉCÉãÇ™Ç†ÇÍÇŒì«Ç›çûÇﬁ
    If Dir$(gstrTmpDir & gcstrShishouFile & gcstrFileExt) <> "" Then
        Call DataLoad
    End If
    
    Me.Show
    
    'É^Éuà⁄ìÆê›íË
    Call gMakeTabOrder(Me, cintNumCtrl, Grid(), intBack(), intNext())

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  'Win98ÇÃÉoÉOâÒîÉRÅ[Éh
  Me.Hide

End Sub

Private Sub Form_Unload(Cancel As Integer)
    'çÏã∆ÉfÉBÉåÉNÉgÉäÇ…ÉtÉ@ÉCÉãÇèëÇ≠
    Call DataSave

End Sub

'faShishou1ÇÃèâä˙âªèàóù
Private Sub faShishouInit()
    Dim Col As Long
    Dim Row As Long
    Dim ix As Integer
    
    'ê°ñ@
    ix = 0
    With faShishou(ix)
        .Rows = 3
        .Cols = 8
        .FixedRows = 1
        .FixedCols = 1
    
        .MergeCells = flexMergeFixedOnly
        .MergeRow(0) = False
        
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        .ColAlignment(.Cols - 1) = flexAlignLeftCenter
        
        'å©èoÇµçsÇÃê›íË
        Col = 0
        .MergeCol(Col) = False
        .ColWidth(Col) = 800
        .TextMatrix(0, Col) = " "
        .TextMatrix(1, Col) = "ãNì_ë§"
        .TextMatrix(2, Col) = "èIì_ë§"
        
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "a"
        '.ColFormat(Col) = "0 "
        
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "b"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "c"
        '.ColFormat(Col) = "0 "
    
        Dim i As Integer
        For i = 1 To 3
            Col = Col + 1
            .ColWidth(Col) = 550
            .TextMatrix(0, Col) = "t" & Format$(i)
            '.ColFormat(Col) = "0 "
        Next
           
        Col = Col + 1
        .ColWidth(Col) = 2600
        .TextMatrix(0, Col) = "ÉsÉbÉ`äÑÇË"
        '.ColFormat(Col) = "0 "
    End With

    'åBç¿ï‚ã≠ìSãÿ
    ix = 1
    With faShishou(ix)
        .Rows = 4
        .Cols = 6
        .FixedRows = 2
        .FixedCols = 1
    
        'ï∂éöÇÃãlÇﬂï˚ê›íË
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        .ColAlignment(2) = flexAlignLeftCenter
        .ColAlignment(4) = flexAlignLeftCenter
        
        'å©èoÇµïîÇÃåãçáê›íË
        .MergeCells = flexMergeFixedOnly
        .MergeCol(0) = True
        .MergeRow(0) = True
        .MergeCol(.Cols - 1) = True
        
        .TextMatrix(0, 0) = " "
        .TextMatrix(1, 0) = " "
        
        .TextMatrix(2, 0) = "ãNì_ë§"
        .TextMatrix(3, 0) = "èIì_ë§"
        
        .TextMatrix(0, 1) = "ê¸òHï˚å¸"
        .TextMatrix(0, 2) = "ê¸òHï˚å¸"
        .TextMatrix(0, 3) = "íºäpï˚å¸"
        .TextMatrix(0, 4) = "íºäpï˚å¸"
        
        .TextMatrix(0, 5) = "Ç©Ç‘ÇË"
        .TextMatrix(1, 5) = "Ç©Ç‘ÇË"
        
        'ÉfÅ[É^ÉtÉHÅ[É}ÉbÉgÇÃê›íË
        'For Col = .FixedCols To .Cols - 1
            .ColFormat(1) = "0 "
            .ColFormat(3) = "0 "
            .ColFormat(5) = "0  "
        'Next
        
        'å©èoÇµçsÇÃê›íË
        .ColWidth(0) = 800
        .ColWidth(1) = 500
        .ColWidth(2) = 1000
        .ColWidth(3) = 500
        .ColWidth(4) = 1000
        .ColWidth(5) = 800
        
        .TextMatrix(1, 1) = "åa"
        .TextMatrix(1, 2) = "ÉsÉbÉ`äÑÇË"
        .TextMatrix(1, 3) = "åa"
        .TextMatrix(1, 4) = "ÉsÉbÉ`äÑÇË"
    End With
    
    'ìSãÿåa
    ix = 2
    With faShishou(ix)
        .Rows = 1
        .Cols = 2
        .FixedRows = 0
        .FixedCols = 1
    
        'ï∂éöÇÃãlÇﬂï˚ê›íË
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        
        'ÉfÅ[É^ÉtÉHÅ[É}ÉbÉgÇÃê›íË
'        .ColFormat(1) = "0 "
'        .ColFormat(3) = "0 "
'        .ColFormat(5) = "0 "
        
        'å©èoÇµçsÇÃê›íË
        .ColWidth(0) = 700
        .ColWidth(1) = 500
        
        .TextMatrix(0, 0) = "ìSãÿåa"
    End With
    
    'ñ≥é˚èkÉÇÉãÉ^Éãï‚ã≠ãÿ
    ix = 3
    With faShishou(ix)
        .Rows = 4
        .Cols = 5
        .FixedRows = 2
        .FixedCols = 1
    
        'ï∂éöÇÃãlÇﬂï˚ê›íË
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        
        .ColAlignment(1) = flexAlignLeftCenter
        .ColAlignment(2) = flexAlignLeftCenter
        .ColAlignment(3) = flexAlignLeftCenter
        .ColAlignment(4) = flexAlignLeftCenter
        
        'å©èoÇµïîÇÃåãçáê›íË
        .MergeCells = flexMergeFixedOnly
        .MergeRow(0) = True
        
        .TextMatrix(0, 0) = " "
        .TextMatrix(1, 0) = " "
        
        .TextMatrix(2, 0) = "ãNì_ë§"
        .TextMatrix(3, 0) = "èIì_ë§"
        
        .TextMatrix(0, 1) = "Ç‡ÇøÇ†Ç›ãÿ"
        .TextMatrix(0, 2) = "Ç‡ÇøÇ†Ç›ãÿ"
        .TextMatrix(0, 3) = "òAåããÿ"
        .TextMatrix(0, 4) = "òAåããÿ"
        
        .TextMatrix(1, 1) = "ê¸òHï˚å¸"
        .TextMatrix(1, 2) = "íºäpï˚å¸"
        .TextMatrix(1, 3) = "ê¸òHï˚å¸"
        .TextMatrix(1, 4) = "íºäpï˚å¸"
        
        'ÉfÅ[É^ÉtÉHÅ[É}ÉbÉgÇÃê›íË
        'For Col = .FixedCols To .Cols - 1
            '.ColFormat(Col) = "0.000 "
        'Next
        
        'å©èoÇµçsÇÃê›íË
        .ColWidth(0) = 800
        For Col = .FixedCols To .Cols - 1
            .ColWidth(Col) = 1000
        Next
    End With
    
    'ÉXÉgÉbÉpÅ[Ç®ÇÊÇ—ç|ëÃÅFê°ñ@
    ix = 4
    With faShishou(ix)
        .Rows = 3
        .Cols = 6
        .FixedRows = 1
        .FixedCols = 1
    
        .MergeCells = flexMergeFixedOnly
        .MergeRow(0) = False
        
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        .ColAlignment(.Cols - 1) = flexAlignLeftCenter
        
        'å©èoÇµçsÇÃê›íË
        Col = 0
        .MergeCol(Col) = False
        .ColWidth(Col) = 800
        .TextMatrix(0, Col) = " "
        .TextMatrix(1, Col) = "ãNì_ë§"
        .TextMatrix(2, Col) = "èIì_ë§"
        
        Col = Col + 1
        .ColWidth(Col) = 630
        .TextMatrix(0, Col) = "a"
        '.ColFormat(Col) = "0 "
        
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "b"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "c"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "ê[Ç≥"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 2000
        .TextMatrix(0, Col) = "ÉsÉbÉ`äÑÇË"
        '.ColFormat(Col) = "0 "
    End With

    'ÉXÉgÉbÉpÅ[Ç®ÇÊÇ—ç|ëÃÅFï‚ã≠ìSãÿ
    ix = 5
    With faShishou(ix)
        .Rows = 5
        .Cols = 9
        .FixedRows = 2
        .FixedCols = 1
    
        'ï∂éöÇÃãlÇﬂï˚ê›íË
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        .ColAlignment(4) = flexAlignLeftCenter
        .ColAlignment(8) = flexAlignLeftCenter
        
        'å©èoÇµïîÇÃåãçáê›íË
        .MergeCells = flexMergeFixedOnly
        .MergeCol(0) = True
        .MergeRow(0) = True
        
        .TextMatrix(0, 0) = " "
        .TextMatrix(1, 0) = " "
        
        For Col = 1 To 4
            .TextMatrix(0, Col) = "ãN ì_ ë§"
        Next
        
        For Col = 5 To .Cols - 1
            .TextMatrix(0, Col) = "èI ì_ ë§"
        Next
        
        'ÉfÅ[É^ÉtÉHÅ[É}ÉbÉgÇÃê›íË
        'For Col = .FixedCols To .Cols - 1
            '.ColFormat(Col) = "0.000 "
        'Next
        
        'å©èoÇµçsÇÃê›íË
        .ColWidth(0) = 800
        For Col = .FixedCols To .Cols - 2
            .ColWidth(Col) = 550
        Next
        .ColWidth(4) = 2000
        .ColWidth(8) = 2000
        
        .TextMatrix(2, 0) = "K1"
        .TextMatrix(3, 0) = "K2"
        .TextMatrix(4, 0) = "K3"
    
        .TextMatrix(1, 1) = "åa"
        .TextMatrix(1, 2) = "L1"
        .TextMatrix(1, 3) = "L2"
        .TextMatrix(1, 4) = "ÉsÉbÉ`äÑÇË"
    
        .TextMatrix(1, 5) = "åa"
        .TextMatrix(1, 6) = "L1"
        .TextMatrix(1, 7) = "L2"
        .TextMatrix(1, 8) = "ÉsÉbÉ`äÑÇË"
    End With

    'ÉTÉCÉYé©ìÆí≤êÆ
    For ix = 0 To cintNumCtrl - 1
        Call gfaAjustSize(faShishou(ix))
    Next

End Sub

'ÉOÉäÉbÉhÇÃÉfÅ[É^ÇÉtÉ@ÉCÉãÇ…èëÇ´çûÇﬁ
'ÉtÉ@ÉCÉãÉtÉHÅ[É}ÉbÉgÇÕ
'   ÉoÅ[ÉWÉáÉìï∂éöóÒ,
'   ÇPÇ¬ñ⁄ÇÃÉOÉäÉbÉhçsêîÅiå≈íËçsÇèúÇ≠Åj,
'   óÒêî,Åiå≈íËçsÇèúÇ≠Åj
'   ÉfÅ[É^ï∂éöóÒ,
'   2Ç¬ñ⁄ÇÃÉOÉäÉbÉhçsêî,
'   óÒêî,
'   ÉfÅ[É^ï∂éöóÒ,
'   ÅEÅEÅE
'ÇÃÇÊÇ§Ç…Ç»Ç¡ÇƒÇ¢ÇÈÅB
'ÉOÉäÉbÉhÇÃå¬êîÇ»Ç«ÇÕä‹Ç‹ÇÍÇƒÇ¢Ç»Ç¢ÇÃÇ≈ÅAÉoÅ[ÉWÉáÉìèÓïÒÇå©ÇƒÉRÅ[ÉhÇ≈ä«óùÇ∑ÇÈÅB
Public Sub DataSave()
    Dim FileNo As Integer
    Dim i As Integer
    
    On Error GoTo ErrorHandle
    bIgnoreHighLight = True
    
    FileNo = FreeFile
    Open gstrTmpDir & gcstrShishouFile & gcstrFileExt For Output As #FileNo
    
    'ÉoÅ[ÉWÉáÉìèÓïÒèëÇ´çûÇ›
    Write #FileNo, gGetCurVersion(gcstrShishouFile)
        
    For i = 0 To cintNumCtrl - 1
        With faShishou(i)
            Write #FileNo, .Rows - .FixedRows
            Write #FileNo, .Cols - .FixedCols
            Write #FileNo, gGridToStr(faShishou(i))
        End With
    Next
    
    Close #FileNo
    
    bIgnoreHighLight = False
    If Me.Visible = True Then If TypeOf Me.ActiveControl Is vsFlexGrid Then Me.ActiveControl.CellBackColor = gclngHighLightColor
    
    Exit Sub
    
ErrorHandle:
    MsgBox "ÉtÉ@ÉCÉãèëÇ´çûÇ›ÉGÉâÅ[ : " & Format$(Err.Number) & vbCrLf & Err.Description, vbCritical + vbOKOnly
    Close #FileNo   'ÉIÅ[ÉvÉìÇµÇ»Ç¢Ç≈ÉNÉçÅ[ÉYÇµÇƒÇ‡ÉGÉâÅ[Ç…ÇÕÇ»ÇÁÇ»Ç¢
    
    bIgnoreHighLight = False
    If Me.Visible = True Then If TypeOf Me.ActiveControl Is vsFlexGrid Then Me.ActiveControl.CellBackColor = gclngHighLightColor

End Sub

'ÉOÉäÉbÉhÇÃÉfÅ[É^ÇÉtÉ@ÉCÉãÇ©ÇÁì«Ç›çûÇﬁ
'ÉtÉ@ÉCÉãÉtÉHÅ[É}ÉbÉgÇÕ
'   ÉoÅ[ÉWÉáÉìï∂éöóÒ,
'   ÇPÇ¬ñ⁄ÇÃÉOÉäÉbÉhçsêîÅiå≈íËçsÇèúÇ≠Åj,
'   óÒêî,Åiå≈íËçsÇèúÇ≠Åj
'   ÉfÅ[É^ï∂éöóÒ,
'   2Ç¬ñ⁄ÇÃÉOÉäÉbÉhçsêî,
'   óÒêî,
'   ÉfÅ[É^ï∂éöóÒ,
'   ÅEÅEÅE
'ÇÃÇÊÇ§Ç…Ç»Ç¡ÇƒÇ¢ÇÈÅB
'ÉOÉäÉbÉhÇÃå¬êîÇ»Ç«ÇÕä‹Ç‹ÇÍÇƒÇ¢Ç»Ç¢ÇÃÇ≈ÅAÉoÅ[ÉWÉáÉìèÓïÒÇå©ÇƒÉRÅ[ÉhÇ≈ä«óùÇ∑ÇÈÅB
'ÉoÅ[ÉWÉáÉìÇ…ç∑àŸÇ™Ç†ÇÈèÍçáÇÕÅAMDIForm_ã¥ãr.faLoadBufÇ…àÍíUèëçûÇÒÇ≈ÅAÇªÇ±Ç©ÇÁìKêÿÇ»ÉZÉãÇ÷ÉRÉsÅ[Ç∑ÇÈÇÊÇ§Ç…Ç∑ÇÈ
Public Sub DataLoad()
    Dim FileNo As Integer
    Dim strVer As String
    Dim lngRows As Long
    Dim lngCols As Long
    Dim strData As String
    Dim i As Integer
    
    On Error GoTo ErrorHandle
    
    FileNo = FreeFile
    Open gstrTmpDir & gcstrShishouFile & gcstrFileExt For Input As #FileNo
    
    'ÉoÅ[ÉWÉáÉìèÓïÒì«Ç›çûÇ›
    Input #FileNo, strVer
        
    For i = 0 To cintNumCtrl - 1
        With faShishou(i)
            Input #FileNo, lngRows
            Input #FileNo, lngCols
            Input #FileNo, strData
        
            Call gStrPasteToGrid(faShishou(i), strData)
        End With
    Next
    
    Close #FileNo
    Exit Sub
    
ErrorHandle:
    MsgBox "ì«Ç›çûÇ›ÉfÅ[É^Ç™ïsë´ÇµÇƒÇ¢Ç‹ÇµÇΩÅB", vbInformation + vbOKOnly
    Close #FileNo   'ÉIÅ[ÉvÉìÇµÇ»Ç¢Ç≈ÉNÉçÅ[ÉYÇµÇƒÇ‡ÉGÉâÅ[Ç…ÇÕÇ»ÇÁÇ»Ç¢

End Sub

Private Sub faShishou_AfterEdit(Index As Integer, ByVal Row As Long, ByVal Col As Long)
    If bolCellNoMove = False Then Call MDIForm_ã¥ãr.SetDataChgFlag(gcfrmShishou)

End Sub

Private Sub faShishou_EnterCell(Index As Integer)
    If bolCellNoMove Then Exit Sub
    
    If faShishou(Index).CellBackColor = vbButtonFace Then Call faShishou_KeyDown(Index, vbKeyReturn, 0)
    If bIgnoreHighLight = False Then faShishou(Index).CellBackColor = gclngHighLightColor

End Sub

Private Sub faShishou_GotFocus(Index As Integer)
    If bolCellNoMove Then Exit Sub
    
    If faShishou(Index).CellBackColor = vbButtonFace Then Call faShishou_KeyDown(Index, vbKeyReturn, 0)
    If bIgnoreHighLight = False Then faShishou(Index).CellBackColor = gclngHighLightColor

End Sub

Private Sub faShishou_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    Dim lngRow As Long
    Dim lngCol As Long
    Dim iMoveID As Integer
    
    If Shift <> 0 Then Exit Sub
    
    With faShishou(Index)
        lngRow = .Row
        lngCol = .Col
    
        Call gSetChgFlagByInkey(Me.Name, KeyCode)
        
        If gfaMoveCell(faShishou(Index), lngRow, lngCol, KeyCode, False, Grid(intNext(.Tag)), Grid(intBack(.Tag))) = 0 Then .Select lngRow, lngCol
    
        Call gfaPutCurCell(faShishou(Index))
    End With

End Sub

Private Sub faShishou_KeyDownEdit(Index As Integer, ByVal Row As Long, ByVal Col As Long, KeyCode As Integer, ByVal Shift As Integer)
    Dim lngRow As Long
    Dim lngCol As Long
    Dim iMoveID As Integer
    
    If Shift <> 0 Then Exit Sub
    
    With faShishou(Index)
        If KeyCode = vbKeyReturn Then
            lngRow = .Row
            lngCol = .Col
        
            If gfaMoveCell(faShishou(Index), lngRow, lngCol, KeyCode, False, Grid(intNext(.Tag)), Grid(intBack(.Tag))) = 0 Then .Select lngRow, lngCol
            
            Call gfaPutCurCell(faShishou(Index))
        End If
    End With

End Sub

Private Sub faShishou_LeaveCell(Index As Integer)
    Call gfaSetCellColor(faShishou(Index), faShishou(Index).Row, faShishou(Index).Col)

End Sub

Private Sub faShishou_LostFocus(Index As Integer)
    Call gfaSetCellColor(faShishou(Index), faShishou(Index).Row, faShishou(Index).Col)

End Sub

Private Sub faShishou_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    If Button = vbRightButton Then Me.PopupMenu MDIForm_ã¥ãr.mnuEdit

End Sub

Private Sub faShishou_ValidateEdit(Index As Integer, ByVal Row As Long, ByVal Col As Long, Cancel As Boolean)
    
    With faShishou(Index)
        
        Select Case Col
'        Case 1, 2, 3, 6
'           If InStr(1, .EditText, ".", vbTextCompare) = 0 Then   'è¨êîì_Ç™Ç»Ç©Ç¡ÇΩÇÁ
'             .EditText = Format(Val(.EditText), "##0")
'           Else
'             .EditText = Format(Val(.EditText), "##0.0")
'           End If
'        Case 4, 5, 7
'           .EditText = Format(Val(.EditText), "##0")
        Case Else
            If .ColFormat(Col) = "" Then Exit Sub
            .EditText = Format(Val(.EditText), .ColFormat(Col))
        End Select

    End With

End Sub

