VERSION 5.00
Object = "{C5DE3F80-3376-11D2-BAA4-04F205C10000}#1.0#0"; "vsFlex6d.ocx"
Begin VB.Form frmShishou 
   Caption         =   "支承"
   ClientHeight    =   8100
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   11355
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   8100
   ScaleWidth      =   11355
   WindowState     =   2  '最大化
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   765
      Index           =   0
      Left            =   360
      TabIndex        =   0
      Top             =   780
      Width           =   9015
      _ExtentX        =   15901
      _ExtentY        =   1349
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ＭＳ ゴシック"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   50
      Cols            =   10
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   765
      Index           =   4
      Left            =   360
      TabIndex        =   4
      Top             =   5100
      Width           =   9015
      _ExtentX        =   15901
      _ExtentY        =   1349
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ＭＳ ゴシック"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   50
      Cols            =   10
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   975
      Index           =   1
      Left            =   360
      TabIndex        =   1
      Top             =   2280
      Width           =   4875
      _ExtentX        =   8599
      _ExtentY        =   1720
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ＭＳ ゴシック"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   975
      Index           =   3
      Left            =   5340
      TabIndex        =   3
      Top             =   2280
      Width           =   4455
      _ExtentX        =   7858
      _ExtentY        =   1720
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ＭＳ ゴシック"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   975
      Index           =   5
      Left            =   360
      TabIndex        =   5
      Top             =   6420
      Width           =   5175
      _ExtentX        =   9128
      _ExtentY        =   1720
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ＭＳ ゴシック"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VSFlex6DAOCtl.vsFlexGrid faShishou 
      Height          =   255
      Index           =   2
      Left            =   7680
      TabIndex        =   2
      Top             =   1680
      Width           =   1515
      _ExtentX        =   2672
      _ExtentY        =   450
      _ConvInfo       =   1
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ＭＳ ゴシック"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483636
      BackColorAlternate=   -2147483643
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   0
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   3
      Cols            =   4
      FixedRows       =   1
      FixedCols       =   1
      RowHeightMin    =   0
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   ""
      ScrollTrack     =   0   'False
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0   'False
      ShowComboButton =   -1  'True
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
   End
   Begin VB.Label Label9 
      AutoSize        =   -1  'True
      Caption         =   "補強鉄筋"
      Height          =   180
      Left            =   360
      TabIndex        =   14
      Top             =   6180
      Width           =   720
   End
   Begin VB.Label Label8 
      AutoSize        =   -1  'True
      Caption         =   "箱抜き寸法"
      Height          =   180
      Left            =   360
      TabIndex        =   13
      Top             =   4860
      Width           =   870
   End
   Begin VB.Label Label7 
      Appearance      =   0  'ﾌﾗｯﾄ
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      BorderStyle     =   1  '実線
      Caption         =   " ストッパー及び鋼棒"
      BeginProperty Font 
         Name            =   "ＭＳ Ｐゴシック"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   240
      TabIndex        =   12
      Top             =   4320
      Width           =   2010
   End
   Begin VB.Label Label6 
      AutoSize        =   -1  'True
      Caption         =   "ピッチ割り"
      Height          =   180
      Left            =   6600
      TabIndex        =   11
      Top             =   2040
      Width           =   945
   End
   Begin VB.Label Label5 
      AutoSize        =   -1  'True
      Caption         =   "(3) 無収縮モルタル補強筋"
      Height          =   180
      Left            =   5340
      TabIndex        =   10
      Top             =   1740
      Width           =   2010
   End
   Begin VB.Label Label4 
      AutoSize        =   -1  'True
      Caption         =   "(2) 沓座補強鉄筋"
      Height          =   180
      Left            =   360
      TabIndex        =   9
      Top             =   1980
      Width           =   1350
   End
   Begin VB.Label Label24 
      AutoSize        =   -1  'True
      Caption         =   "(1) 寸法"
      Height          =   180
      Left            =   360
      TabIndex        =   8
      Top             =   540
      Width           =   630
   End
   Begin VB.Label Label2 
      Caption         =   "単位 mm"
      Height          =   180
      Left            =   1920
      TabIndex        =   7
      Top             =   240
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Label Label1 
      Appearance      =   0  'ﾌﾗｯﾄ
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      BorderStyle     =   1  '実線
      Caption         =   " 支 承 "
      BeginProperty Font 
         Name            =   "ＭＳ Ｐゴシック"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   240
      TabIndex        =   6
      Top             =   180
      Width           =   705
   End
End
Attribute VB_Name = "frmShishou"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Const cintNumCtrl As Integer = 6
Dim Grid(cintNumCtrl - 1) As Object
Dim intBack(cintNumCtrl - 1) As Integer  '前のグリッドナンバー
Dim intNext(cintNumCtrl - 1) As Integer  '次のグリッドナンバー

Dim bIgnoreHighLight As Boolean
Dim bLoadNow As Boolean
Dim bolCellNoMove As Boolean

Private Sub Form_Load()
    Dim i As Integer

    Call faShishouInit
    
    '作業ディレクトリにファイルがあれば読み込む
    If Dir$(gstrTmpDir & gcstrShishouFile & gcstrFileExt) <> "" Then
        Call DataLoad
    End If
    
    Me.Show
    
    'タブ移動設定
    Call gMakeTabOrder(Me, cintNumCtrl, Grid(), intBack(), intNext())

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  'Win98のバグ回避コード
  Me.Hide

End Sub

Private Sub Form_Unload(Cancel As Integer)
    '作業ディレクトリにファイルを書く
    Call DataSave

End Sub

'faShishou1の初期化処理
Private Sub faShishouInit()
    Dim Col As Long
    Dim Row As Long
    Dim ix As Integer
    
    '寸法
    ix = 0
    With faShishou(ix)
        .Rows = 3
        .Cols = 8
        .FixedRows = 1
        .FixedCols = 1
    
        .MergeCells = flexMergeFixedOnly
        .MergeRow(0) = False
        
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        .ColAlignment(.Cols - 1) = flexAlignLeftCenter
        
        '見出し行の設定
        Col = 0
        .MergeCol(Col) = False
        .ColWidth(Col) = 800
        .TextMatrix(0, Col) = " "
        .TextMatrix(1, Col) = "起点側"
        .TextMatrix(2, Col) = "終点側"
        
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "a"
        '.ColFormat(Col) = "0 "
        
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "b"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "c"
        '.ColFormat(Col) = "0 "
    
        Dim i As Integer
        For i = 1 To 3
            Col = Col + 1
            .ColWidth(Col) = 550
            .TextMatrix(0, Col) = "t" & Format$(i)
            '.ColFormat(Col) = "0 "
        Next
           
        Col = Col + 1
        .ColWidth(Col) = 2600
        .TextMatrix(0, Col) = "ピッチ割り"
        '.ColFormat(Col) = "0 "
    End With

    '沓座補強鉄筋
    ix = 1
    With faShishou(ix)
        .Rows = 4
        .Cols = 6
        .FixedRows = 2
        .FixedCols = 1
    
        '文字の詰め方設定
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        .ColAlignment(2) = flexAlignLeftCenter
        .ColAlignment(4) = flexAlignLeftCenter
        
        '見出し部の結合設定
        .MergeCells = flexMergeFixedOnly
        .MergeCol(0) = True
        .MergeRow(0) = True
        .MergeCol(.Cols - 1) = True
        
        .TextMatrix(0, 0) = " "
        .TextMatrix(1, 0) = " "
        
        .TextMatrix(2, 0) = "起点側"
        .TextMatrix(3, 0) = "終点側"
        
        .TextMatrix(0, 1) = "線路方向"
        .TextMatrix(0, 2) = "線路方向"
        .TextMatrix(0, 3) = "直角方向"
        .TextMatrix(0, 4) = "直角方向"
        
        .TextMatrix(0, 5) = "かぶり"
        .TextMatrix(1, 5) = "かぶり"
        
        'データフォーマットの設定
        'For Col = .FixedCols To .Cols - 1
            .ColFormat(1) = "0 "
            .ColFormat(3) = "0 "
            .ColFormat(5) = "0  "
        'Next
        
        '見出し行の設定
        .ColWidth(0) = 800
        .ColWidth(1) = 500
        .ColWidth(2) = 1000
        .ColWidth(3) = 500
        .ColWidth(4) = 1000
        .ColWidth(5) = 800
        
        .TextMatrix(1, 1) = "径"
        .TextMatrix(1, 2) = "ピッチ割り"
        .TextMatrix(1, 3) = "径"
        .TextMatrix(1, 4) = "ピッチ割り"
    End With
    
    '鉄筋径
    ix = 2
    With faShishou(ix)
        .Rows = 1
        .Cols = 2
        .FixedRows = 0
        .FixedCols = 1
    
        '文字の詰め方設定
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        
        'データフォーマットの設定
'        .ColFormat(1) = "0 "
'        .ColFormat(3) = "0 "
'        .ColFormat(5) = "0 "
        
        '見出し行の設定
        .ColWidth(0) = 700
        .ColWidth(1) = 500
        
        .TextMatrix(0, 0) = "鉄筋径"
    End With
    
    '無収縮モルタル補強筋
    ix = 3
    With faShishou(ix)
        .Rows = 4
        .Cols = 5
        .FixedRows = 2
        .FixedCols = 1
    
        '文字の詰め方設定
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        
        .ColAlignment(1) = flexAlignLeftCenter
        .ColAlignment(2) = flexAlignLeftCenter
        .ColAlignment(3) = flexAlignLeftCenter
        .ColAlignment(4) = flexAlignLeftCenter
        
        '見出し部の結合設定
        .MergeCells = flexMergeFixedOnly
        .MergeRow(0) = True
        
        .TextMatrix(0, 0) = " "
        .TextMatrix(1, 0) = " "
        
        .TextMatrix(2, 0) = "起点側"
        .TextMatrix(3, 0) = "終点側"
        
        .TextMatrix(0, 1) = "もちあみ筋"
        .TextMatrix(0, 2) = "もちあみ筋"
        .TextMatrix(0, 3) = "連結筋"
        .TextMatrix(0, 4) = "連結筋"
        
        .TextMatrix(1, 1) = "線路方向"
        .TextMatrix(1, 2) = "直角方向"
        .TextMatrix(1, 3) = "線路方向"
        .TextMatrix(1, 4) = "直角方向"
        
        'データフォーマットの設定
        'For Col = .FixedCols To .Cols - 1
            '.ColFormat(Col) = "0.000 "
        'Next
        
        '見出し行の設定
        .ColWidth(0) = 800
        For Col = .FixedCols To .Cols - 1
            .ColWidth(Col) = 1000
        Next
    End With
    
    'ストッパーおよび鋼体：寸法
    ix = 4
    With faShishou(ix)
        .Rows = 3
        .Cols = 6
        .FixedRows = 1
        .FixedCols = 1
    
        .MergeCells = flexMergeFixedOnly
        .MergeRow(0) = False
        
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        .ColAlignment(.Cols - 1) = flexAlignLeftCenter
        
        '見出し行の設定
        Col = 0
        .MergeCol(Col) = False
        .ColWidth(Col) = 800
        .TextMatrix(0, Col) = " "
        .TextMatrix(1, Col) = "起点側"
        .TextMatrix(2, Col) = "終点側"
        
        Col = Col + 1
        .ColWidth(Col) = 630
        .TextMatrix(0, Col) = "a"
        '.ColFormat(Col) = "0 "
        
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "b"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "c"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 550
        .TextMatrix(0, Col) = "深さ"
        '.ColFormat(Col) = "0 "
    
        Col = Col + 1
        .ColWidth(Col) = 2000
        .TextMatrix(0, Col) = "ピッチ割り"
        '.ColFormat(Col) = "0 "
    End With

    'ストッパーおよび鋼体：補強鉄筋
    ix = 5
    With faShishou(ix)
        .Rows = 5
        .Cols = 9
        .FixedRows = 2
        .FixedCols = 1
    
        '文字の詰め方設定
        For Col = 0 To .Cols - 1
            .FixedAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = 0 To .FixedCols - 1
            .ColAlignment(Col) = flexAlignCenterCenter
        Next
        For Col = .FixedCols To .Cols - 1
            .ColAlignment(Col) = flexAlignRightCenter
        Next
        .ColAlignment(4) = flexAlignLeftCenter
        .ColAlignment(8) = flexAlignLeftCenter
        
        '見出し部の結合設定
        .MergeCells = flexMergeFixedOnly
        .MergeCol(0) = True
        .MergeRow(0) = True
        
        .TextMatrix(0, 0) = " "
        .TextMatrix(1, 0) = " "
        
        For Col = 1 To 4
            .TextMatrix(0, Col) = "起 点 側"
        Next
        
        For Col = 5 To .Cols - 1
            .TextMatrix(0, Col) = "終 点 側"
        Next
        
        'データフォーマットの設定
        'For Col = .FixedCols To .Cols - 1
            '.ColFormat(Col) = "0.000 "
        'Next
        
        '見出し行の設定
        .ColWidth(0) = 800
        For Col = .FixedCols To .Cols - 2
            .ColWidth(Col) = 550
        Next
        .ColWidth(4) = 2000
        .ColWidth(8) = 2000
        
        .TextMatrix(2, 0) = "K1"
        .TextMatrix(3, 0) = "K2"
        .TextMatrix(4, 0) = "K3"
    
        .TextMatrix(1, 1) = "径"
        .TextMatrix(1, 2) = "L1"
        .TextMatrix(1, 3) = "L2"
        .TextMatrix(1, 4) = "ピッチ割り"
    
        .TextMatrix(1, 5) = "径"
        .TextMatrix(1, 6) = "L1"
        .TextMatrix(1, 7) = "L2"
        .TextMatrix(1, 8) = "ピッチ割り"
    End With

    'サイズ自動調整
    For ix = 0 To cintNumCtrl - 1
        Call gfaAjustSize(faShishou(ix))
    Next

End Sub

'グリッドのデータをファイルに書き込む
'ファイルフォーマットは
'   バージョン文字列,
'   １つ目のグリッド行数（固定行を除く）,
'   列数,（固定行を除く）
'   データ文字列,
'   2つ目のグリッド行数,
'   列数,
'   データ文字列,
'   ・・・
'のようになっている。
'グリッドの個数などは含まれていないので、バージョン情報を見てコードで管理する。
Public Sub DataSave()
    Dim FileNo As Integer
    Dim i As Integer
    
    On Error GoTo ErrorHandle
    bIgnoreHighLight = True
    
    FileNo = FreeFile
    Open gstrTmpDir & gcstrShishouFile & gcstrFileExt For Output As #FileNo
    
    'バージョン情報書き込み
    Write #FileNo, gGetCurVersion(gcstrShishouFile)
        
    For i = 0 To cintNumCtrl - 1
        With faShishou(i)
            Write #FileNo, .Rows - .FixedRows
            Write #FileNo, .Cols - .FixedCols
            Write #FileNo, gGridToStr(faShishou(i))
        End With
    Next
    
    Close #FileNo
    
    bIgnoreHighLight = False
    If Me.Visible = True Then If TypeOf Me.ActiveControl Is vsFlexGrid Then Me.ActiveControl.CellBackColor = gclngHighLightColor
    
    Exit Sub
    
ErrorHandle:
    MsgBox "ファイル書き込みエラー : " & Format$(Err.Number) & vbCrLf & Err.Description, vbCritical + vbOKOnly
    Close #FileNo   'オープンしないでクローズしてもエラーにはならない
    
    bIgnoreHighLight = False
    If Me.Visible = True Then If TypeOf Me.ActiveControl Is vsFlexGrid Then Me.ActiveControl.CellBackColor = gclngHighLightColor

End Sub

'グリッドのデータをファイルから読み込む
'ファイルフォーマットは
'   バージョン文字列,
'   １つ目のグリッド行数（固定行を除く）,
'   列数,（固定行を除く）
'   データ文字列,
'   2つ目のグリッド行数,
'   列数,
'   データ文字列,
'   ・・・
'のようになっている。
'グリッドの個数などは含まれていないので、バージョン情報を見てコードで管理する。
'バージョンに差異がある場合は、MDIForm_橋脚.faLoadBufに一旦書込んで、そこから適切なセルへコピーするようにする
Public Sub DataLoad()
    Dim FileNo As Integer
    Dim strVer As String
    Dim lngRows As Long
    Dim lngCols As Long
    Dim strData As String
    Dim i As Integer
    
    On Error GoTo ErrorHandle
    
    FileNo = FreeFile
    Open gstrTmpDir & gcstrShishouFile & gcstrFileExt For Input As #FileNo
    
    'バージョン情報読み込み
    Input #FileNo, strVer
        
    For i = 0 To cintNumCtrl - 1
        With faShishou(i)
            Input #FileNo, lngRows
            Input #FileNo, lngCols
            Input #FileNo, strData
        
            Call gStrPasteToGrid(faShishou(i), strData)
        End With
    Next
    
    Close #FileNo
    Exit Sub
    
ErrorHandle:
    MsgBox "読み込みデータが不足していました。", vbInformation + vbOKOnly
    Close #FileNo   'オープンしないでクローズしてもエラーにはならない

End Sub

Private Sub faShishou_AfterEdit(Index As Integer, ByVal Row As Long, ByVal Col As Long)
    If bolCellNoMove = False Then Call MDIForm_橋脚.SetDataChgFlag(gcfrmShishou)

End Sub

Private Sub faShishou_EnterCell(Index As Integer)
    If bolCellNoMove Then Exit Sub
    
    If faShishou(Index).CellBackColor = vbButtonFace Then Call faShishou_KeyDown(Index, vbKeyReturn, 0)
    If bIgnoreHighLight = False Then faShishou(Index).CellBackColor = gclngHighLightColor

End Sub

Private Sub faShishou_GotFocus(Index As Integer)
    If bolCellNoMove Then Exit Sub
    
    If faShishou(Index).CellBackColor = vbButtonFace Then Call faShishou_KeyDown(Index, vbKeyReturn, 0)
    If bIgnoreHighLight = False Then faShishou(Index).CellBackColor = gclngHighLightColor

End Sub

Private Sub faShishou_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    Dim lngRow As Long
    Dim lngCol As Long
    Dim iMoveID As Integer
    
    If Shift <> 0 Then Exit Sub
    
    With faShishou(Index)
        lngRow = .Row
        lngCol = .Col
    
        Call gSetChgFlagByInkey(Me.Name, KeyCode)
        
        If gfaMoveCell(faShishou(Index), lngRow, lngCol, KeyCode, False, Grid(intNext(.Tag)), Grid(intBack(.Tag))) = 0 Then .Select lngRow, lngCol
    
        Call gfaPutCurCell(faShishou(Index))
    End With

End Sub

Private Sub faShishou_KeyDownEdit(Index As Integer, ByVal Row As Long, ByVal Col As Long, KeyCode As Integer, ByVal Shift As Integer)
    Dim lngRow As Long
    Dim lngCol As Long
    Dim iMoveID As Integer
    
    If Shift <> 0 Then Exit Sub
    
    With faShishou(Index)
        If KeyCode = vbKeyReturn Then
            lngRow = .Row
            lngCol = .Col
        
            If gfaMoveCell(faShishou(Index), lngRow, lngCol, KeyCode, False, Grid(intNext(.Tag)), Grid(intBack(.Tag))) = 0 Then .Select lngRow, lngCol
            
            Call gfaPutCurCell(faShishou(Index))
        End If
    End With

End Sub

Private Sub faShishou_LeaveCell(Index As Integer)
    Call gfaSetCellColor(faShishou(Index), faShishou(Index).Row, faShishou(Index).Col)

End Sub

Private Sub faShishou_LostFocus(Index As Integer)
    Call gfaSetCellColor(faShishou(Index), faShishou(Index).Row, faShishou(Index).Col)

End Sub

Private Sub faShishou_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    If Button = vbRightButton Then Me.PopupMenu MDIForm_橋脚.mnuEdit

End Sub

Private Sub faShishou_ValidateEdit(Index As Integer, ByVal Row As Long, ByVal Col As Long, Cancel As Boolean)
    
    With faShishou(Index)
        
        Select Case Col
'        Case 1, 2, 3, 6
'           If InStr(1, .EditText, ".", vbTextCompare) = 0 Then   '小数点がなかったら
'             .EditText = Format(Val(.EditText), "##0")
'           Else
'             .EditText = Format(Val(.EditText), "##0.0")
'           End If
'        Case 4, 5, 7
'           .EditText = Format(Val(.EditText), "##0")
        Case Else
            If .ColFormat(Col) = "" Then Exit Sub
            .EditText = Format(Val(.EditText), .ColFormat(Col))
        End Select

    End With

End Sub

